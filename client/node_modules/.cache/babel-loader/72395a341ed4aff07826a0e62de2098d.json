{"ast":null,"code":"/*\n * memoize\n * by stagas\n *\n * MIT licenced\n */\n// global options\nvar options = {\n  target: null,\n  expire: 30000,\n  exclude: [],\n  only: [],\n  error: true,\n  debug: false,\n  store: null\n};\n\nvar toSource = require('tosource'); // memoize\n\n\nmodule.exports = exports = function memoize() {\n  // copy global options\n  var opts = {};\n\n  for (var k in options) {\n    opts[k] = options[k];\n  } // parse options\n\n\n  var arg,\n      args = [].slice.call(arguments);\n\n  while (arg = args.shift()) if ('object' === typeof arg) {\n    if (Array.isArray(arg)) opts.only = arg;else if (opts.target == null) opts.target = arg;else for (var k in arg) opts[k] = arg[k];\n  } else if ('function' === typeof arg) {\n    opts.target = arg;\n  } else if ('number' === typeof arg) {\n    opts.expire = arg;\n  } else if ('string' === typeof arg) {\n    opts.id = arg;\n  }\n\n  var id = opts.id || Math.floor(Math.random() * 100000000).toString(36),\n      store = opts.store || new MemoryStore(opts.debug),\n      target = opts.target,\n      debug = opts.debug;\n  debug && console.log(opts);\n  if (!target) throw new Error('No target object specified');\n\n  function wrapper(method) {\n    return function () {\n      var self = this,\n          args = [].slice.call(arguments),\n          cb = args.pop(); // memoize id, hash method name and arguments\n\n      var hash = id + ('undefined' === typeof method ? '' : '.' + method) + '=' + toSource(args); // callback cache if we have it\n\n      store.get(hash, function (err, cached) {\n        debug && console.log('in cache', hash);\n        if (!err && cached && (!cached.expires || cached.expires >= Date.now())) return cb.apply(self, cached.args);\n        args.push(function (err) {\n          var self = this,\n              cbargs = [].slice.call(arguments); // no caching if there's an error\n          // unless error = false is used\n\n          if (!opts.error || !err) {\n            debug && console.log('caching', hash);\n            store.set(hash, {\n              args: cbargs,\n              expires: 'number' === typeof opts.expire ? Date.now() + opts.expire : false\n            }, function (err) {\n              if (err) throw err;\n              debug && console.log('cached', hash);\n              cb.apply(self, cbargs);\n            });\n          } else cb.apply(self, cbargs);\n        }); // is it an object method or a function\n\n        method ? target[method].apply(target, args) : target.apply(target, args);\n      });\n    };\n  } // memoized object\n\n\n  var memoized; // target is a function\n\n  if ('function' === typeof target) {\n    memoized = wrapper();\n  } else {\n    // target is an object\n    memoized = {};\n    Object.keys(target) // instance methods\n    .concat(Object.keys(target.__proto__)) // prototype methods\n    .forEach(function (method) {\n      if ('function' !== typeof target[method]) return;\n\n      if (!opts.only.length && !opts.exclude.length || opts.only.length && ~opts.only.indexOf(method) || opts.exclude.length && !~opts.exclude.indexOf(method)) {\n        debug && console.log('adding method', method);\n        memoized[method] = wrapper(method);\n      } else memoized[method] = target[method].bind(target);\n    });\n  } // private clear cache method\n\n\n  memoized.__clearMemoizeCache__ = function (cb) {\n    store.clear(cb);\n  };\n\n  return memoized;\n}; // clear cache of a memoized object\n\n\nexports.clear = function (memoized, cb) {\n  memoized.__clearMemoizeCache__(cb);\n}; // set an option value\n\n\nexports.set = function (k, v) {\n  if ('object' === typeof k) {\n    for (var key in k) options[key] = k[key];\n  } else options[k] = v;\n}; // get an option value\n\n\nexports.get = function (k) {\n  return options[k];\n}; // MemoryStore\n\n\nfunction MemoryStore() {\n  this.data = {};\n}\n\nMemoryStore.prototype.get = function (key, cb) {\n  cb(null, this.data[key]);\n};\n\nMemoryStore.prototype.set = function (key, val, cb) {\n  this.data[key] = val;\n  cb(null);\n};\n\nMemoryStore.prototype.clear = function (cb) {\n  this.data = {};\n  cb(null);\n};","map":{"version":3,"sources":["D:/Web/Web/Udemy course/Complete React developer/e-commerce_shop/node_modules/memoize/memoize.js"],"names":["options","target","expire","exclude","only","error","debug","store","toSource","require","module","exports","memoize","opts","k","arg","args","slice","call","arguments","shift","Array","isArray","id","Math","floor","random","toString","MemoryStore","console","log","Error","wrapper","method","self","cb","pop","hash","get","err","cached","expires","Date","now","apply","push","cbargs","set","memoized","Object","keys","concat","__proto__","forEach","length","indexOf","bind","__clearMemoizeCache__","clear","v","key","data","prototype","val"],"mappings":"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","sourcesContent":["/*\n * memoize\n * by stagas\n *\n * MIT licenced\n */\n\n// global options\nvar options = {\n  target  : null\n, expire  : 30000\n, exclude : []\n, only    : []\n, error   : true\n, debug   : false\n, store   : null\n}\n\nvar toSource = require('tosource')\n\n// memoize\nmodule.exports = exports = function memoize () {\n  // copy global options\n  var opts = {}\n  for (var k in options) {\n    opts[k] = options[k]\n  }\n\n  // parse options\n  var arg, args = [].slice.call(arguments)\n  while (arg = args.shift())\n    if ('object' === typeof arg) {\n      if (Array.isArray(arg)) opts.only = arg\n      else if (opts.target == null) opts.target = arg\n      else for (var k in arg) opts[k] = arg[k]\n    } else if ('function' === typeof arg) {\n      opts.target = arg\n    } else if ('number' === typeof arg) {\n      opts.expire = arg\n    } else if ('string' === typeof arg) {\n      opts.id = arg\n    }\n\n  var id = opts.id || Math.floor(Math.random() * 100000000).toString(36)\n    , store = opts.store || new MemoryStore(opts.debug)\n    , target = opts.target\n    , debug = opts.debug\n\n  debug && console.log(opts)\n\n  if (!target)\n    throw new Error('No target object specified')\n\n  function wrapper (method) {\n    return function () {\n      var self = this\n        , args = [].slice.call(arguments)\n        , cb = args.pop()\n\n      // memoize id, hash method name and arguments\n      var hash = id + ('undefined' === typeof method ? '' : '.' + method) + '=' + toSource(args)\n\n      // callback cache if we have it\n      store.get(hash, function (err, cached) {\n        debug && console.log('in cache', hash)\n        if (!err && cached && (!cached.expires || cached.expires >= Date.now())) return cb.apply(self, cached.args)\n        args.push(function (err) {\n          var self = this\n            , cbargs = [].slice.call(arguments)\n\n          // no caching if there's an error\n          // unless error = false is used\n          if (!opts.error || !err) {\n            debug && console.log('caching', hash)\n            store.set(hash, {\n              args: cbargs\n            , expires: 'number' === typeof opts.expire\n              ? Date.now() + opts.expire\n              : false\n            }, function (err) {\n              if (err) throw err\n              debug && console.log('cached', hash)\n              cb.apply(self, cbargs)\n            })\n          } else cb.apply(self, cbargs)\n        })\n\n        // is it an object method or a function\n        method\n          ? target[method].apply(target, args)\n          : target.apply(target, args)        \n      })\n    }\n  }\n\n  // memoized object\n  var memoized\n\n  // target is a function\n  if ('function' === typeof target) {\n    memoized = wrapper()\n  } else { // target is an object\n    memoized = {}\n    Object.keys(target) // instance methods\n      .concat(Object.keys(target.__proto__)) // prototype methods\n      .forEach(function (method) {\n      if ('function' !== typeof target[method]) return\n      if (!opts.only.length && !opts.exclude.length\n        || opts.only.length && ~opts.only.indexOf(method)\n        || opts.exclude.length && !~opts.exclude.indexOf(method)\n        ) {\n        debug && console.log('adding method', method)\n        memoized[method] = wrapper(method)\n      } else memoized[method] = target[method].bind(target)\n    })\n  }\n\n  // private clear cache method\n  memoized.__clearMemoizeCache__ = function (cb) {\n    store.clear(cb)\n  }\n \n  return memoized\n}\n\n// clear cache of a memoized object\nexports.clear = function (memoized, cb) {\n  memoized.__clearMemoizeCache__(cb)\n}\n\n// set an option value\nexports.set = function (k, v) {\n  if ('object' === typeof k) {\n    for (var key in k)\n      options[key] = k[key]\n  } else options[k] = v\n}\n\n// get an option value\nexports.get = function (k) {\n  return options[k]\n}\n\n// MemoryStore\nfunction MemoryStore () {\n  this.data = {}\n}\n\nMemoryStore.prototype.get = function (key, cb) {\n  cb(null, this.data[key])\n}\n\nMemoryStore.prototype.set = function (key, val, cb) {\n  this.data[key] = val\n  cb(null)\n}\n\nMemoryStore.prototype.clear = function (cb) {\n  this.data = {}\n  cb(null)\n}"]},"metadata":{},"sourceType":"script"}